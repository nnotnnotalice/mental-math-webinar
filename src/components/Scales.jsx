// src/components/Scales.jsx
import { useEffect, useRef } from "react";
import "./scales.css";

/**
 * Props:
 * - bowlLevel: "LOW" | "MID" | "HIGH" | "BALANCED"
 */
export default function Scales({ bowlLevel = "LOW" }) {
  const beamRef = useRef(null);
  const rightGroupRef = useRef(null);

  useEffect(() => {
    const map = {
      LOW: { rightY: 30, angle: 8 },
      MID: { rightY: 26, angle: 6.5 },
      HIGH: { rightY: 15, angle: 3 },
      BALANCED: { rightY: 0, angle: 0 },
    };

    const cfg = map[bowlLevel] ?? map.LOW;

    const DURATION = 450;
    const EASING = "cubic-bezier(0.22, 1, 0.36, 1)";

    if (beamRef.current) {
      beamRef.current.animate([{ transform: `rotate(${cfg.angle}deg)` }], {
        duration: DURATION,
        easing: EASING,
        fill: "forwards",
      });
    }

    if (rightGroupRef.current) {
      rightGroupRef.current.animate([{ transform: `translateY(${cfg.rightY}px)` }], {
        duration: DURATION,
        easing: EASING,
        fill: "forwards",
      });
    }
  }, [bowlLevel]);

  return (
    <svg
      className="scalesSvg"
      width="555"
      height="268"
      viewBox="0 0 555 268"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      {/* BEAM (коромысло) — вращаем */}
      <g id="beam" ref={beamRef}>
        <path
          d="M440.559 100.578L289.569 92.05V91.9609H263.042L110.503 100.578V112.15L263.042 128.137H289.569V127.977L440.559 112.15V100.578Z"
          fill="#5691F0"
        />
      </g>

      {/* RIGHT GROUP — всё, что должно ходить вместе с правой чашей */}
      <g id="rightGroup" ref={rightGroupRef}>
        {/* правая стойка */}
        <path
          d="M446.381 144.444C439.064 144.444 433.118 138.498 433.118 131.181V65.6645H459.645V131.181C459.645 138.498 453.699 144.444 446.381 144.444Z"
          fill="#5691F0"
        />
        <path
          d="M459.645 112.345C459.645 115.934 462.554 118.843 466.143 118.843C469.732 118.843 472.641 115.934 472.641 112.345V102.607C472.641 99.0177 469.732 96.1084 466.143 96.1084C462.554 96.1084 459.645 99.0177 459.645 102.607V112.345Z"
          fill="#336ECC"
        />
        {/* правая “палка” */}
        <path
          d="M342.499 78.2876H459.662C462.244 78.2876 464.345 76.1868 464.345 73.6053C464.345 71.0238 462.244 68.923 459.662 68.923H344.671L329.52 51.0484C328.63 49.998 327.312 49.3928 325.941 49.3928H296.993C294.412 49.3928 292.311 51.4936 292.311 54.0751C292.311 56.6566 294.412 58.7574 296.993 58.7574H323.769L338.92 76.6318C339.81 77.6822 341.128 78.2876 342.499 78.2876Z"
          fill="#2D2E83"
        />

        {/* правая чаша */}
        <path
          d="M325.02 0H554.663C554.663 38.4532 534.357 69.6757 509.348 69.6757H370.315C345.306 69.6757 325 38.4532 325 0H325.02Z"
          fill="#FD9F4D"
        />
        <path
          d="M538.622 53.3687C536.817 55.848 534.618 58.1149 532.08 60.1267C524.625 66.0205 514.347 69.6757 502.978 69.6757H376.667C361.437 69.6757 348.138 63.1161 341.023 53.3687H538.64H538.622Z"
          fill="#FD8B3F"
        />
      </g>

      {/* центральная стойка (статично) */}
      <path
        d="M291.74 110.049L295.924 179.429L296.761 193.387L297.081 198.71H253.997L254.247 193.387L254.888 179.429L258.092 110.049H291.74Z"
        fill="#5691F0"
      />
      <path
        d="M275.54 135.917C289.276 135.917 300.411 124.782 300.411 111.046C300.411 97.3102 289.276 86.1748 275.54 86.1748C261.804 86.1748 250.668 97.3102 250.668 111.046C250.668 124.782 261.804 135.917 275.54 135.917Z"
        fill="#336ECC"
      />

      {/* основание (статично) */}
      <path
        d="M48.9919 255.769H113.102C113.102 262.517 107.618 268 100.871 268H61.2228C54.4754 268 48.9919 262.517 48.9919 255.769Z"
        fill="#609AE8"
      />
      <path
        d="M436.036 255.769H500.146C500.146 262.517 494.663 268 487.915 268H448.267C441.52 268 436.036 262.517 436.036 255.769Z"
        fill="#609AE8"
      />
      <path
        d="M502.265 255.769H48.8139C42.6539 255.769 38.0963 250.019 39.5206 244.019L47.6389 209.712C49.9355 200.027 62.0952 193.404 77.9046 193.404H473.157C488.966 193.404 501.126 200.027 503.422 209.712L511.541 244.019C512.965 250.019 508.407 255.769 502.247 255.769H502.265Z"
        fill="#336ECC"
      />

      {/* левая стойка + детали (статично) */}
      <path
        d="M101.418 65.6829H127.945V131.199C127.945 138.516 121.998 144.463 114.681 144.463C107.364 144.463 101.418 138.516 101.418 131.199V65.6829Z"
        fill="#5691F0"
      />
      <path
        d="M101.418 102.589C101.418 99.0002 98.5082 96.0908 94.9193 96.0908C91.3304 96.0908 88.421 99.0002 88.421 102.589V112.327C88.421 115.916 91.3304 118.826 94.9193 118.826C98.5082 118.826 101.418 115.916 101.418 112.327V102.589Z"
        fill="#336ECC"
      />

      {/* левая чаша (статично) */}
      <path
        d="M0.0196956 0H229.663C229.663 37.9013 209.357 68.6757 184.348 68.6757H45.3148C20.3061 68.6757 0 37.9013 0 0H0.0196956Z"
        fill="#FD9F4D"
      />
      <path
        d="M213.622 52.6028C211.817 55.0466 209.618 57.2809 207.08 59.2638C199.626 65.073 189.347 68.6758 177.978 68.6758H51.6674C36.4372 68.6758 23.1376 62.2103 16.0231 52.6028H213.64H213.622Z"
        fill="#FD8B3F"
      />

      {/* левая “палка” */}
      <path
        d="M208.563 78.2876H91.3993C88.8178 78.2876 86.717 76.1868 86.717 73.6053C86.717 71.0238 88.8178 68.923 91.3993 68.923H206.391L221.542 51.0484C222.432 49.998 223.749 49.3928 225.12 49.3928H254.068C256.65 49.3928 258.751 51.4936 258.751 54.0751C258.751 56.6566 256.65 58.7574 254.068 58.7574H227.292L212.142 76.6318C211.251 77.6822 209.934 78.2876 208.563 78.2876Z"
        fill="#2D2E83"
      />
    </svg>
  );
}